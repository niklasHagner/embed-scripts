function browserIsFromMicrosoft(){var t=window.navigator.userAgent;return-1!==t.indexOf("MSIE ")||-1!==t.indexOf("Trident/")||-1!==t.indexOf("Edge/")}Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),i=this,n=function(){},r=function(){return i.apply(this instanceof n&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};return n.prototype=this.prototype,r.prototype=new n,r}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){var i;if(null===this||this===undefined)throw new TypeError('"this" is null or not defined');var n=Object(this),r=n.length>>>0;if(0===r)return-1;var a=+e||0;if(Math.abs(a)===Infinity&&(a=0),r<=a)return-1;for(i=Math.max(0<=a?a:r-Math.abs(a),0);i<r;){if(i in n&&n[i]===t)return i;i++}return-1}),function(p,g,t){var i,n,r,a,o=browserIsFromMicrosoft()?/^frameStart/:/^frameReady/,h=["https://infogr.am","https://e.infogr.am","https://infogram.com","https://e.infogram.com"],c=p.getComputedStyle||function(t){return t.currentStyle},f=(i=[],n=[],r=function(t,e){if(Array.prototype.indexOf)return t.indexOf(e);var i,n=-1;for(i=0;i<t.length;i++)if(this[i]===e){n=i;break}return n},a=function(t,e){return-1!==r(t,e)},{add:function(t,e){a(i,t)||a(n,e)||(i.push(t),n.push(e))},contains:function(t){return a(i,t)},id:function(t){var e=r(i,t);return 0<=e?n[e]:null}});function l(t){if(t.parentNode){var e=(n=t,Array.prototype.indexOf.call(n.parentNode.childNodes,n)),i=l(t.parentNode);return i.push(e),i}var n;return[]}function d(t){return!(t.left===t.right&&t.top===t.bottom&&t.right===t.top&&0===t.top)}function e(t,e){this.queue=t||[],this.processing=0,this.origin=e,this.infographics={},this.legacyList=[],this.addIframesListener(),this.addScrollListener(),this.initWatcher(),this.handleResizeEvent()}var s=e.prototype;function u(){var t,e=[];if(g.querySelectorAll)t=g.querySelectorAll(".infogram-embed");else if(g.getElementsByClassName)t=g.getElementsByClassName("infogram-embed");else{t=[];for(var i=g.getElementsByTagName("div"),n=i.length,r=0;r<n;r++){var a=i[r];a.className&&-1!==a.className.indexOf("infogram-embed")&&t.push(a)}}for(var s=t.length,o=0;o<s;o++){var h=t[o];if(!h.getAttribute("data-processed")){var c=h.getAttribute("data-id"),f=h.getAttribute("data-type"),l=h.getAttribute("data-title"),d=h.getAttribute("data-extra")||"",u=p.getComputedStyle(h);"0px"==u.getPropertyValue("height")&&"0px"==u.getPropertyValue("min-height")&&h.style.setProperty("min-height","1px"),h.setAttribute("data-processed",1),e.push({container:h,extra:d,id:c,title:l,type:f,activated:!1,frameReady:!1})}}return e}function m(t){if(g.contains)return g.contains(t);for(var e=g.documentElement;t;){if(t===e)return!0;t=t.parentNode}return!1}function v(t,e,i,n){t.addEventListener?t.addEventListener(e,i,!!n&&{passive:!0}):t.attachEvent?t.attachEvent("on"+e,function(){return i.call(t,p.event)}):t["on"+e]=i}if(s.addIframesListener=function(){v(p,"message",this.handleMessageEvent.bind(this))},s.addScrollListener=function(){v(p,"scroll",this.handleScrollEvent.bind(this),!0),v(p,"resize",this.handleResizeEvent.bind(this))},s.handleResizeEvent=function(){this.vWidth=p.innerWidth||g.documentElement.clientWidth,this.vHeight=p.innerHeight||g.documentElement.clientHeight,this.handleScrollEvent()},s.checkVisible=function(){var t,e;for(t in this.infographics)if(this.infographics.hasOwnProperty(t)){var i=this.infographics[t];!i.activationSent&&i.canReceiveEvents&&(e=this.isElementVisible(i.iframe()))&&(this.sendToIframe(t,"visibleRegion:"+JSON.stringify(e)),i.activationSent=!0),!i.activated&&i.frameReady&&(e=this.isElementVisible(i.iframe()))&&(i.activated=!0)}this.sortQueue();var n=[];this.queue.forEach(function(t){this.isElementVisible(t.container)&&!t.viewed&&(t.viewed=!0,n.push(t))}.bind(this)),n.forEach(function(t){this.processInfographic(t)}.bind(this))},s.handleScrollEvent=function(){this.scrollBuffer||(this.scrollBuffer=requestAnimationFrame(function(){this.checkVisible(),this.scrollBuffer=null}.bind(this)))},s.handleMessageEvent=function(t){if(this.origin!==t.origin){var e=/^https?:\/\//,i="https://",n=this.origin.replace(e,i),r=t.origin.replace(e,i);if(r!==n&&-1===h.indexOf(r))return;-1===this.origin.indexOf(i)&&0===t.origin.indexOf(i)&&(this.origin=n)}var a=t.source;if(!f.contains(a))for(var s in this.infographics)if(this.infographics.hasOwnProperty(s)&&this.infographics[s].iframe().contentWindow===a){f.add(a,s);break}var o=f.id(a);o&&o in this.infographics&&this.handleIframeEvent(o,t.data)},s.handleIframeEvent=function(t,e){if("string"==typeof e){var i,n=e.split(":").shift(),r=this.infographics[t];if(o.test(n)&&(this.processing--,0===this.processing&&(this.checkVisible(),this.processOne())),"frameReady"===e)return this.infographics[t].frameReady=!0,void this.handleScrollEvent();if(/^iframeLoaded/.test(n))this.infographics[t].canReceiveEvents=!0,this.handleResizeEvent(),this.sendToIframe(t,"iframeWidth:"+r.containerWidth);else if(/^iframeHeight/.test(n)){i=r.iframe();var a=e.substr(n.length+1).replace(/^\s+|\s+$/g,""),s=a+"px";i.style.height!==s&&(i.style.height=s,r.iframeHeight=a,this.fixForGannett(r))}}},s.fixForGannett=function(t){var e=t.container.parentNode;if(e&&e.parentNode){var i=e.parentNode;if(i&&i.className&&-1!==i.className.indexOf("oembed-infogram")){var n=t.containerWidth,r=t.iframeHeight||t.iframe.style.height;i.setAttribute("data-width",n),i.setAttribute("data-height",r),$&&$.data&&($(i).data("width",n),$(i).data("height",r))}}},s.sendToIframe=function(t,e){var i=this.infographics[t];i&&i.iframe()&&i.iframe().contentWindow.postMessage(e,this.origin)},s.isElementVisible=function(t){if(!t)return!1;var e=t.getBoundingClientRect();if(e.right<0||e.bottom<0||e.left>this.vWidth||e.top>this.vHeight)return!1;if(0===e.width&&0===e.height&&0===e.left&&0===e.top)return!1;var i=Math.min(this.vWidth-e.left,e.width),n=Math.min(this.vHeight-e.top,e.height),r=-1*Math.min(e.left,-0);return{top:-1*Math.min(e.top,-0),left:r,width:i,height:n}},s.initWatcher=function(){setInterval(function(){var t;for(t in this.infographics)if(this.infographics.hasOwnProperty(t)){var e,i=this.infographics[t];if(i.container&&m(i.container))e=i.container;else{if(!(e=g.getElementById(t))){delete this.infographics[t];continue}i.container=e}var n=e.offsetWidth;if(n&&i.containerWidth!==n){i.containerWidth=n;var r=c(e),a=this.getHorizBorders(r)+this.getHorizPaddings(r),s=parseInt(n,10)-a;i.iframe&&(i.iframe().style.width=s+"px",this.sendToIframe(t,"iframeWidth:"+s))}}this.legacyList&&this.legacyList.length&&(this.queue=this.legacyList.slice(0),this.legacyList.length=0,this.processQueue())}.bind(this),200)},s.getHorizBorders=function(t){return parseInt(t.getPropertyValue("border-left-width")||0,10)+parseInt(t.getPropertyValue("border-right-width")||0,10)},s.getHorizPaddings=function(t){return parseInt(t.getPropertyValue("padding-left")||0,10)+parseInt(t.getPropertyValue("padding-right")||0,10)},s.add=function(t,e,i,n,r){this.queue.push({id:t,title:n,container:e,type:i,extra:r}),0===this.processing&&this.processQueue()},s.processInfographic=function(t){var e=this.queue.indexOf(t);if(!(e<0)){this.queue.splice(e,1);var i=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return"ig-"+t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}();t.id=t.id.replace("infogram_0_","").replace(/(http(s?):\/\/infogr(\.am|am\.com)\/)/,"").replace(/\s/g,""),t.container.id=i,t.containerWidth=parseInt(t.container.offsetWidth,10);var n,r=this.createIframe(t.id,t.title||"",t.type,t.containerWidth,t.extra);t.iframe=(n=t,function(){return n.container.getElementsByTagName("iframe")[0]}),t.container.appendChild(r),this.infographics[i]=t,this.processing++}},s.sortQueue=function(){this.queue.sort(function(t,e){return function(t,e){var i=t.getBoundingClientRect(),n=e.getBoundingClientRect(),r=d(i);if(r!=d(n))return r?-1:1;var a=Math.abs(i.top)-Math.abs(n.top);if(0!=a)return a;for(var s=0,o=l(t),h=l(e);s<o.length&&s<h.length&&o[s]===h[s];)s++;return s<o.length&&s<h.length?o[s]-h[s]:0}(t.container,e.container)})},s.processOne=function(){0!==this.queue.length&&(this.sortQueue(),this.processInfographic(this.queue[0]))},s.processQueue=function(){for(;0<this.queue.length;)this.processOne()},s.createIframe=function(t,e,i,n,r){var a=g.createElement("iframe"),s=this.origin+"/"+t+"?src=embed";"image"===i&&(s+="&type=image"),r&&(s+="&extra="+r),e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;");var o=a.style;return o.border="none",o.width=n+"px",o.height="130px",a.src=s,a.setAttribute("scrolling","no"),a.setAttribute("frameborder","0"),a.setAttribute("allowfullscreen",""),e&&a.setAttribute("title",e),a},s.process=function(){for(var t=u(),e=t.length,i=0;i<e;i++){var n=t[i];this.add(n.id,n.container,n.type,n.title,n.extra)}},!p[t]||!p[t].initialized){var y;y=!!g.getElementById("infogram-async")?g.getElementById("infogram-async").src:p[t].script;var b=u();p[t]&&p[t].list&&p[t].list.length&&Array.prototype.push.apply(b,p[t].list);var E=new e(b,function(t){var e=g.createElement("A");e.href=t;var i=e.port&&80!=e.port&&443!=e.port?":"+e.port:"",n="http:";return 2<e.protocol.length?n=e.protocol:2<p.location.protocol.length&&(n=p.location.protocol),n+"//"+e.hostname+i}(y));E.processOne(),p[t]={add:E.add.bind(E),process:E.process.bind(E),list:E.legacyList,initialized:!0}}}(window,document,"InfogramEmbeds");
